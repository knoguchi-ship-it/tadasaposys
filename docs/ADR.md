# アーキテクチャ意思決定記録 (ADR)

本プロジェクトにおける重要な技術選定および設計判断の記録。

## ADR-001: 認証・認可の二重ガード (Security)
### ステータス
承認済み (Approved)
（内容は既存通り）

---

## ADR-002: React on GAS (Frontend Architecture)
### ステータス
承認済み (Approved)
（内容は既存通り）

---

## ADR-003: タイムスタンプによる主キー管理 (Data Modeling)
### ステータス
承認済み (Approved)
（内容は既存通り）

---

## ADR-004: ライブラリバージョンの固定 (Dependency Management)
### ステータス
承認済み (Approved)

### コンテキスト
`esm.sh` などのCDNを利用してライブラリを読み込む際、バージョン指定が緩い（例: `^18.2.0` や指定なし）と、依存関係解決の過程で意図せず最新版（React 19など）が読み込まれる場合がある。
これにより、アプリケーション本体が参照するReactと、UIライブラリが参照するReactが別インスタンスとなり、`Minified React error #31` 等のクリティカルなエラーが発生した。

### 決定事項
**すべての外部ライブラリの読み込みにおいて、バージョンを完全固定し、かつ依存関係（deps）を明示する。**

*   **悪い例**: `https://esm.sh/lucide-react`
*   **良い例**: `https://esm.sh/lucide-react@0.330.0?deps=react@18.2.0`

### 影響
*   ライブラリのアップデート時は、手動でURLを書き換える必要がある。
*   予期せぬ破壊的変更によるシステムダウンを確実に防ぐことができる。