
# タダサポ管理システム 引き継ぎ書（環境構築・運用マニュアル）

**作成日:** 2026/01/27  
**更新日:** 2026/02/20  
**対象:** 開発者 / システム管理者 / スタッフ

本ドキュメントは、タダサポ管理アプリケーションの環境構築および開発を即座に開始するための手順書です。

## 1. 前提条件
*   Google Workspaceアカウント、またはGmailアカウントを保有していること。
*   対象のスプレッドシートへの編集権限があること。

## 2. スプレッドシートの準備

### 2.1 新規作成または既存利用
Googleスプレッドシートを用意します。

### 2.2 シート（タブ）名の設定
以下のシート名を正確に設定してください（空白スペース等に注意）。
1.  `案件リスト`
2.  `サポート記録`
3.  `タダメンマスタ`
4.  `設定`（初回は `setupSettingsSheet` で自動作成可）

※ `メール履歴` シートは、アプリ初回送信時に自動作成されます。

### 2.3 列構成の確認（重要）
SDDに基づき、以下の列が正しく配置されているか確認してください。
*   **案件リスト**: A列=タイムスタンプ ... **I列(9列目)=サービス種別**
*   **タダメンマスタ**: C列(3列目)にメールアドレス（A列=ID, B列=氏名, C列=メール）

## 3. アプリケーションの操作

### 3.1 案件の閲覧とアクセス制限
本システムでは、情報の錯綜を防ぐため以下の表示ルールが適用されます。

*   **未対応タブ**: 全てのスタッフが閲覧可能です。ここから担当する案件を選んでください。
*   **対応中/完了タブ**: **自分が担当している案件のみ**が表示されます。他のスタッフが対応している案件は、通常モードでは表示されません。

### 3.2 全体状況の確認（ダッシュボードモード）
他のスタッフの対応状況や、全体の進捗を確認したい場合は、画面上の**「全体を表示（閲覧のみ）」スイッチ**をONにしてください。

*   **ONの状態**: すべての案件が表示されますが、記録の編集やメール送信はできません（閲覧専用）。
*   **OFFの状態**: 通常の業務モードに戻ります。

## 4. GASプロジェクトのセットアップ手順

1.  スプレッドシートのメニューから **拡張機能 > Apps Script** を開く。
2.  **コードファイルの配置**:
    *   デフォルトのコードを削除し、納品された `コード.js`（GAS上のファイル名は任意）の内容を貼り付ける。
3.  **IDの設定**:
    *   `コード.js` 上部 `SPREADSHEET_ID` を、現在のスプレッドシートID（URLの `/d/` と `/edit` の間の文字列）に書き換える。
    *   `setupSettingsSheet` を1回実行し、「設定」シートを作成する。
    *   「設定」シートの `ADMIN_EMAILS` に管理者メールアドレスを設定する（カンマ区切りで複数可）。
    *   ファイル添付を使う場合は「設定」シートの `ATTACHMENT_FOLDER_ID` にDriveフォルダIDを設定する。
4.  **index.html の配置**:
    *   「ファイル」の `+` ボタンから HTML を選択し、ファイル名を `index` とする。
    *   納品された `index.html` (Reactアプリのビルド内容) をすべて貼り付ける。
5.  **サービスの追加（必須）**:
    *   エディタ左側の「サービス」の `+` をクリック。
    *   **Google Calendar API** を選択し「追加」。
    *   再度 `+` をクリックし、**Gmail API** を選択し「追加」。

## 5. 動作確認とデプロイ

### 5.1 初回認証
1.  `コード.js` 内の `getInitialData` 関数を選択し、「実行」をクリックする。
2.  「承認が必要です」と出るので、権限を許可する（カレンダー、メール、シートへのアクセス権）。

### 5.2 デプロイ
1.  画面右上の「デプロイ」 > 「新しいデプロイ」を選択。
2.  **種類**: 「ウェブアプリ」
3.  **説明**: 「Initial Deploy v1.4」など
4.  **次のユーザーとして実行**: 「自分」（推奨）
5.  **アクセスできるユーザー**: 「Googleアカウントを持つ全員」または「組織内のユーザー」
6.  「デプロイ」ボタンを押下し、発行されたURLを開く。

## 6. トラブルシューティング

*   **Q. 「アクセス権限がありません」画面が表示される。**
    *   A. アクセスしているGoogleアカウントのメールアドレスが、「タダメンマスタ」シートのC列に登録されているか確認してください。
*   **Q. 自分の案件が見つからない。**
    *   A. 「全体を表示」スイッチがOFFになっているか確認してください。また、誤って担当者が外れていないか、ダッシュボードモードで全体を確認してください。
*   **Q. 編集ボタンが押せない。**
    *   A. 「全体を表示」スイッチがON（閲覧モード）になっていませんか？OFFに切り替えてください。
